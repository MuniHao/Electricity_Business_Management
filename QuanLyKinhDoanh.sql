use master;
CREATE DATABASE QuanLyDien;
GO

USE QuanLyDien;
GO
CREATE LOGIN mylogin WITH PASSWORD='mylogin', CHECK_POLICY = OFF;
GO
sp_changedbowner mylogin;
ALTER AUTHORIZATION ON DATABASE::QuanLyDien TO mylogin;
GO

-- Tạo bảng KHACHHANG
CREATE TABLE KHACHHANG (
    MAKH CHAR(4) PRIMARY KEY,
    TENKHACH CHAR(10),
    DIACHI CHAR(40)
);

-- Tạo bảng SUDUNG
CREATE TABLE SUDUNG (
    MASD CHAR(2) PRIMARY KEY,
    LOAISD CHAR(15),
    DONGIA INT
);

-- Tạo bảng CHITIET
CREATE TABLE CHITIET (
    MASD CHAR(2),
    MAKH CHAR(4),
    SOKW INT,
    THANHTIEN INT,
    PRIMARY KEY (MASD, MAKH),
    FOREIGN KEY (MASD) REFERENCES SUDUNG(MASD),
    FOREIGN KEY (MAKH) REFERENCES KHACHHANG(MAKH)
);

INSERT INTO KHACHHANG (MAKH, TENKHACH, DIACHI) VALUES
('KH01', 'THANH', '12 YERSIN PHU CUONG'),
('KH02', 'HAO', '04 BACH DANG PHO CUONG'),
('KH03', 'HO', '12 DT743 PHU HOA'),
('KH04', 'TIEN', '04 DAI LO BINH DUONG'),
('KH05', 'HOA', '03 DT743 PHU HOA'),
('KH06', 'VAN', '12 CMTS PHU CUONG');

INSERT INTO SUDUNG (MASD, LOAISD, DONGIA) VALUES
('KD', 'KINH DOANH', 750),
('SH', 'SINH HOAT', 500),
('SX', 'SAN XUAT', 100);

--chỉ chèn SOKW, để THANHTIEN là NULL)
INSERT INTO CHITIET (MASD, MAKH, SOKW, THANHTIEN) VALUES
('KD', 'KH01', 100, NULL),
('KD', 'KH02', 200, NULL),
('KD', 'KH04', 50, NULL),
('KD', 'KH05', 300, NULL),
('SH', 'KH01', 150, NULL),
('SH', 'KH02', 50, NULL),
('SH', 'KH03', 360, NULL),
('SH', 'KH04', 400, NULL),
('SH', 'KH05', 200, NULL),
('SX', 'KH01', 150, NULL),
('SX', 'KH02', 220, NULL),
('SX', 'KH03', 300, NULL);

SELECT * FROM KHACHHANG;
SELECT * FROM SUDUNG;
SELECT * FROM CHITIET;


UPDATE CHITIET
SET THANHTIEN = NULL;
